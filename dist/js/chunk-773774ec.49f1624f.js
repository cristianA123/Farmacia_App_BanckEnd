(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-773774ec"],{f5e6b:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"d-flex flex-column flex-grow-1"},[t("div",{staticClass:"d-flex align-center pb-3"},[e._m(0),t("v-spacer"),t("v-spacer"),t("BackPage",{attrs:{to:"services"}})],1),t("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(a){return a.preventDefault(),e.submit.apply(null,arguments)}}},[t("v-card-text",[t("v-card",{attrs:{outlined:""}},[t("v-card-text",[t("v-col",{staticClass:"pt-0"},[t("v-data-table",{attrs:{headers:e.headers,items:e.$store.state.sms.file.example,"items-per-page":5,"hide-default-footer":""}})],1),t("Message-Input-Component",{attrs:{"is-agenda":!1,"example-item":e.$store.state.sms.file.example,errors:e.errors,vars:e.vars},on:{onChangeMessage:e.onChangeMessage}})],1),t("v-card-actions",[t("v-row",{attrs:{justify:"center"}},[t("v-btn",{attrs:{color:"primary",dark:"",type:"submit"}},[e._v(" Siguiente "),t("v-icon",[e._v(" mdi-chevron-right ")])],1)],1)],1)],1)],1)],1),t("PreviewSmsComponent",{ref:"dialogPreview",attrs:{options:e.options,"data-campaing":e.dataCampaing,"message-example":e.messageExample,"is-excel":!0,"is-btn-loading":e.isBtnLoading},on:{onPreviewSmsSubmit:e.PreviewSmsSubmit}})],1)},i=[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"display-1"},[e._v("SMS Excel Scheduled")])])}],n=t("1da1"),r=(t("ac1f"),t("1276"),t("b0c0"),t("96cf"),t("88f5")),o=t("d0b4"),l=t("b570"),c=t("7812"),d={components:{MessageInputComponent:o["a"],BackPage:l["a"],PreviewSmsComponent:c["a"]},data:function(){return{vars:[{text:"VAR1",value:"VAR1"},{text:"VAR2",value:"VAR2"},{text:"VAR3",value:"VAR3"},{text:"VAR4",value:"VAR4"}],optionsShow:!1,errors:{scheduled:"",message:""},headers:[{text:"Número",value:"TELEFONO"},{text:"VAR 1",value:"VAR1"},{text:"VAR 2",value:"VAR2"},{text:"VAR 3",value:"VAR3"},{text:"VAR 4",value:"VAR4"}],excelExample:[],rows:0,name:"",file:null,message:"",messageExample:"",url_id:"",long_url:"",options:{is_push:!1,scheduled:null,is_bidireccional:!1},isFileLoading:!1,errorMessageFile:null,fileId:null,dataCampaing:{},isBtnLoading:!0}},computed:{showExample:function(){return 0!==this.excelExample.length},exampleExelComputed:function(){return this.excelExample}},mounted:function(){this.fileExist()},methods:{fileExist:function(){var e;null!==(e=this.$store.state.sms.file)&&void 0!==e&&e.id||this.$router.push({name:"sms-excel"})},availableCreditByUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var t,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log(null===(t=e.$store.state.sms.file)||void 0===t?void 0:t.id),i={message:e.message,sms_excel_id:null===(s=e.$store.state.sms.file)||void 0===s?void 0:s.id},console.log(i),r["a"].post("/calculateMessageCreditsSmsScheduledExcel",i).then((function(a){a.data.success&&(console.log(a.data.data),e.dataCampaing=a.data.data,e.isBtnLoading=!1)}));case 4:case"end":return a.stop()}}),a)})))()},onChangeOptions:function(e){this.options=e},errorFile:function(e){this.isFileLoading=!1,this.errors.file=[e]},onChangeExcel:function(e){var a=this;if(e)if(this.isFileLoading=!0,"xlsx"===e.name.split(".").pop()||"xls"===e.name.split(".").pop()){var t=new FormData;t.append("file",e),r["a"].post("/sms/upload/excelcampaing",t).then((function(e){e.data.success?(a.fileId=e.data.data.id,a.excelExample=e.data.data.example,a.rows=e.data.data.rows,a.destinatarios=a.fileUploaded,a.errorFile(null),a.errors={name:"",scheduled:"",message:"",file:""}):a.errorFile(e.data.message),a.isFileLoading=!1})).catch((function(e){a.isFileLoading=!1,a.fileId=null,a.errors=e.response.data.errors}))}else console.log("error"),this.errorFile("No es un archivo Excel")},submit:function(){this.$refs.form.validate()&&this.openPreviewComponent()},openPreviewComponent:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.availableCreditByUser();case 2:e.optionsShow=!1,e.$refs.dialogPreview.open();case 4:case"end":return a.stop()}}),a)})))()},PreviewSmsSubmit:function(){var e=this,a={service_id:1,name:this.$store.state.sms.name,destinations:this.$store.state.sms.file.id,message:this.message,url_id:this.url_id,options:this.options,long_url:this.long_url};r["a"].post("/campaign/scheduled",a).then((function(a){a.data.success&&(e.$store.dispatch("app/showToast",a.data.message),e.$router.push({name:"reports"}))})).catch((function(a){e.$store.dispatch("app/showToast","No se pudo enviar la campaña, revise los datos ingresados"),e.errors=a.response.data.errors}))},onChangeMessage:function(e,a,t,s){this.message=e,this.messageExample=a,this.url_id=t,this.long_url=s}}},u=d,m=t("2877"),p=t("6544"),f=t.n(p),h=t("8336"),v=t("b0af"),g=t("99d9"),x=t("62ad"),w=t("8fea"),b=t("4bd4"),C=t("132d"),V=t("0fd9"),R=t("2fa4"),_=Object(m["a"])(u,s,i,!1,null,null,null);a["default"]=_.exports;f()(_,{VBtn:h["a"],VCard:v["a"],VCardActions:g["a"],VCardText:g["c"],VCol:x["a"],VDataTable:w["a"],VForm:b["a"],VIcon:C["a"],VRow:V["a"],VSpacer:R["a"]})}}]);