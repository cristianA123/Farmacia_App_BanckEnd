(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22a183"],{dff1:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"d-flex flex-column flex-grow-1"},[t("div",{staticClass:"d-flex align-center pb-3"},[e._m(0),t("v-spacer"),t("BackPage",{attrs:{to:"create-campaing-sms"}})],1),t("v-card",[t("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(a){return a.preventDefault(),e.submit.apply(null,arguments)}}},[t("v-card-text",[t("v-text-field",{attrs:{label:"Ingrese nombre de campaña","prepend-icon":"mdi-tag-text-outline","error-messages":e.isValidName,rules:[function(e){return!!e||"Ingrese nombre de campaña"}],required:"",outlined:""},model:{value:e.name,callback:function(a){e.name=a},expression:"name"}}),t("v-select",{attrs:{label:"Seleccione una nueva agenda",items:e.agendas,"item-text":"name","item-value":"id","prepend-icon":"mdi-contacts-outline",outlined:"",rules:[function(e){return!!e||"Seleccione agenda"}],required:""},on:{change:e.cambio},model:{value:e.agendaSelected,callback:function(a){e.agendaSelected=a},expression:"agendaSelected"}}),e.showExample?t("v-col",{staticClass:"pt-0"},[t("p",[e._v("Ejemplos:")]),t("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.exampleContact,"items-per-page":5}})],1):e._e(),t("Message-Input-Component",{attrs:{agenda:!0,excel:!1,errors:e.errors},on:{onChangeMessage:e.onChangeMessage}}),t("Options-Component",{attrs:{errors:e.errors},on:{onChange:e.onChangeOptions}})],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:"",color:"primary"},on:{click:e.submit}},[e._v(" Enviar mensaje ")])],1)],1)],1),t("PreviewSmsComponent",{ref:"dialogPreview",attrs:{options:e.options,message:e.message,exampleContact:e.exampleContactComputed,isBtnLoading:e.isBtnLoading,creditToUse:e.creditToUse,availableCredit:e.availableCredit},on:{onPreviewSmsSubmit:e.PreviewSmsSubmit}})],1)},s=[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"display-1"},[e._v("Enviar SMS a una agenda de contactos")])])}],r=t("1da1"),i=(t("96cf"),t("b0c0"),t("d81d"),t("6d60")),o=t("88f5"),c=t("d0b4"),d=t("b570"),l=t("7812"),u=t("c1df"),m=t.n(u),p=(t("898b"),{components:{OptionsComponent:i["a"],MessageInputComponent:c["a"],BackPage:d["a"],PreviewSmsComponent:l["a"]},data:function(){return{errors:{name:"",scheduled:"",message:""},name:"",options:{},headers:[{text:"Número",value:"number"},{text:"Primer nombre",value:"name1"},{text:"Segundo nombre",value:"name2"},{text:"Primer Apellido",value:"last_name1"},{text:"Segundo Apellido",value:"last_name2"},{text:"Email",value:"email"},{text:"VAR 1",value:"var1"},{text:"VAR 2",value:"var2"},{text:"VAR 3",value:"var3"},{text:"VAR 4",value:"var4"}],exampleContact:[],agendas:[],agendaSelected:null,message:"",url_id:"",long_url:"",breadcrumbs:[{text:"Servicios",disabled:!1,to:"/services"},{text:"SMS",disabled:!1,to:"/sms/create_campaing/"},{text:"Agenda",disabled:!0,to:"/sms/create_campaing/sms_agenda"}],creditToUse:0,availableCredit:0,numberOfContacts:0,isBtnLoading:!0}},computed:{showExample:function(){return 0!==this.exampleContact.length},exampleContactComputed:function(){return this.exampleContact},horaIs:function(){m()().add(2,"m").format("HH:mm");var e=m()().format("ll");return e},isValidName:function(){return void 0===this.errors.name?"":this.errors.name[0]}},created:function(){this.getAgendas()},methods:{calculateCreditToUse:function(){var e=this;this.agendas.map((function(a){return a.id===e.agendaSelected?(e.numberOfContacts=a.all_contacts,a.all_contacts):null}));var a={message:this.message,numberOfContacts:this.numberOfContacts};o["a"].post("/calculateMessageCredits",a).then((function(a){a.data.success&&(e.creditToUse=a.data.data.creditsToUse)}))},availableCreditByUser:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.calculateCreditToUse();case 2:o["a"].get("/creditsUsedByUser").then((function(a){a.data.success&&(e.availableCredit=a.data.data.availableCredit,e.isBtnLoading=!1)}));case 3:case"end":return a.stop()}}),a)})))()},submit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.$refs.form.validate()){a.next=4;break}return a.next=3,e.availableCreditByUser();case 3:e.$refs.dialogPreview.open();case 4:case"end":return a.stop()}}),a)})))()},getAgendas:function(){var e=this;o["a"].get("/agenda").then((function(a){a.data.success&&(e.agendas=a.data.data)}))},onChangeOptions:function(e){this.options=e},PreviewSmsSubmit:function(){var e=this,a={service_id:1,campaign_type_id:2,name:this.name,destinations:this.agendaSelected,message:this.message,url_id:this.url_id,options:this.options,long_url:this.long_url};o["a"].post("/campaign",a).then((function(a){a.data.success&&e.$store.dispatch("app/showToast",a.data.message),e.$router.push({name:"reports"})})).catch((function(a){e.errors=a.response.data.errors}))},onChangeMessage:function(e,a,t){this.message=e,this.url_id=a,this.long_url=t},cambio:function(){var e=this,a={agenda_id:this.agendaSelected};o["a"].post("/showContactExample",a).then((function(a){a.data.success&&(e.exampleContact=a.data.data)})).catch((function(a){e.$store.dispatch("app/showToast",a.response.data.message)}))}}}),g=p,v=t("2877"),f=t("6544"),h=t.n(f),b=t("8336"),C=t("b0af"),x=t("99d9"),_=t("62ad"),S=t("8fea"),w=t("4bd4"),V=t("b974"),T=t("2fa4"),k=t("8654"),O=Object(v["a"])(g,n,s,!1,null,null,null);a["default"]=O.exports;h()(O,{VBtn:b["a"],VCard:C["a"],VCardActions:x["a"],VCardText:x["c"],VCol:_["a"],VDataTable:S["a"],VForm:w["a"],VSelect:V["a"],VSpacer:T["a"],VTextField:k["a"]})}}]);