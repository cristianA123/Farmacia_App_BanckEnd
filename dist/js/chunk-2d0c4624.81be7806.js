(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c4624"],{"3b32":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"d-flex flex-column flex-grow-1"},[a("div",{staticClass:"d-flex align-center pb-3"},[e._m(0),a("v-spacer"),a("v-spacer"),a("BackPage",{attrs:{to:"services"}})],1),a("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[a("v-card-text",[a("v-card",{attrs:{outlined:""}},[a("v-card-text",[a("v-col",{staticClass:"pt-0"},[a("v-data-table",{attrs:{headers:e.headers,items:e.$store.state.sms.file.example,"items-per-page":5,"hide-default-footer":""}})],1),a("Message-Input-Component",{attrs:{"is-agenda":!1,"example-item":e.$store.state.sms.file.example,errors:e.errors,vars:e.vars},on:{onChangeMessage:e.onChangeMessage}})],1),a("v-card-actions",[a("v-row",{attrs:{justify:"center"}},[a("v-btn",{attrs:{color:"primary",dark:"",type:"submit"}},[e._v(" Siguiente "),a("v-icon",[e._v(" mdi-chevron-right ")])],1)],1)],1)],1)],1),[a("div",{staticClass:"text-center"},[a("v-bottom-sheet",{attrs:{inset:""},model:{value:e.optionsShow,callback:function(t){e.optionsShow=t},expression:"optionsShow"}},[a("Options-Component",{staticClass:"ml-3",attrs:{errors:e.errors},on:{onChange:e.onChangeOptions,onSubmit:e.openPreviewComponent}})],1)],1)]],2),a("PreviewSmsComponent",{ref:"dialogPreview",attrs:{options:e.options,"data-campaing":e.dataCampaing,"message-example":e.messageExample,"is-excel":!0,"is-btn-loading":e.isBtnLoading},on:{onPreviewSmsSubmit:e.PreviewSmsSubmit}})],1)},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"display-1"},[e._v("SMS Excel")])])}],i=a("1da1"),o=(a("ac1f"),a("1276"),a("b0c0"),a("96cf"),a("6d60")),r=a("88f5"),l=a("d0b4"),c=a("b570"),u=a("7812"),d={components:{OptionsComponent:o["a"],MessageInputComponent:l["a"],BackPage:c["a"],PreviewSmsComponent:u["a"]},data:function(){return{vars:[{text:"VAR1",value:"VAR1"},{text:"VAR2",value:"VAR2"},{text:"VAR3",value:"VAR3"},{text:"VAR4",value:"VAR4"},{text:"VAR5",value:"VAR5"},{text:"VAR6",value:"VAR6"},{text:"VAR7",value:"VAR7"},{text:"VAR8",value:"VAR8"}],optionsShow:!1,errors:{scheduled:"",message:""},headers:[{text:"Número",value:"CELULAR"},{text:"VAR 1",value:"VAR1"},{text:"VAR 2",value:"VAR2"},{text:"VAR 3",value:"VAR3"},{text:"VAR 4",value:"VAR4"},{text:"VAR 5",value:"VAR5"},{text:"VAR 6",value:"VAR6"},{text:"VAR 7",value:"VAR7"},{text:"VAR 8",value:"VAR8"}],excelExample:[],rows:0,name:"",file:null,message:"",messageExample:"",url_id:"",long_url:"",options:{is_push:!1,scheduled:null,bidireccional:!1},isFileLoading:!1,errorMessageFile:null,fileId:null,dataCampaing:{},isBtnLoading:!0}},computed:{showExample:function(){return 0!==this.excelExample.length},exampleExelComputed:function(){return this.excelExample}},mounted:function(){this.fileExist()},methods:{fileExist:function(){var e;null!==(e=this.$store.state.sms.file)&&void 0!==e&&e.id||this.$router.push({name:"sms-excel"})},availableCreditByUser:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log(null===(a=e.$store.state.sms.file)||void 0===a?void 0:a.id),n={message:e.message,sms_excel_id:null===(s=e.$store.state.sms.file)||void 0===s?void 0:s.id},console.log(n),r["a"].post("/calculateMessageCreditsSmsExcel",n).then((function(t){t.data.success&&(console.log(t.data.data),e.dataCampaing=t.data.data,e.isBtnLoading=!1)}));case 4:case"end":return t.stop()}}),t)})))()},onChangeOptions:function(e){this.options=e},errorFile:function(e){this.isFileLoading=!1,this.errors.file=[e]},onChangeExcel:function(e){var t=this;if(e)if(this.isFileLoading=!0,"xlsx"===e.name.split(".").pop()||"xls"===e.name.split(".").pop()){var a=new FormData;a.append("file",e),r["a"].post("/sms/upload/excelcampaing",a).then((function(e){e.data.success?(t.fileId=e.data.data.id,t.excelExample=e.data.data.example,t.rows=e.data.data.rows,t.destinatarios=t.fileUploaded,t.errorFile(null),t.errors={name:"",scheduled:"",message:"",file:""}):t.errorFile(e.data.message),t.isFileLoading=!1})).catch((function(e){t.isFileLoading=!1,t.fileId=null,t.errors=e.response.data.errors}))}else console.log("error"),this.errorFile("No es un archivo Excel")},submit:function(){this.$refs.form.validate()&&(this.optionsShow=!0)},openPreviewComponent:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.availableCreditByUser();case 2:e.optionsShow=!1,e.$refs.dialogPreview.open();case 4:case"end":return t.stop()}}),t)})))()},PreviewSmsSubmit:function(){var e=this,t={service_id:1,campaign_type_id:3,name:this.$store.state.sms.name,destinations:this.$store.state.sms.file.id,message:this.message,url_id:this.url_id,options:this.options,long_url:this.long_url};r["a"].post("/campaign",t).then((function(t){t.data.success&&(e.$store.dispatch("app/showToast",t.data.message),e.$router.push({name:"reports"}))})).catch((function(t){e.$store.dispatch("app/showToast","No se pudo enviar la campaña, revise los datos ingresados"),e.errors=t.response.data.errors}))},onChangeMessage:function(e,t,a,s){this.message=e,this.messageExample=t,this.url_id=a,this.long_url=s}}},p=d,m=a("2877"),v=a("6544"),h=a.n(v),f=a("288c"),g=a("8336"),x=a("b0af"),V=a("99d9"),R=a("62ad"),w=a("8fea"),A=a("4bd4"),C=a("132d"),b=a("0fd9"),_=a("2fa4"),S=Object(m["a"])(p,s,n,!1,null,null,null);t["default"]=S.exports;h()(S,{VBottomSheet:f["a"],VBtn:g["a"],VCard:x["a"],VCardActions:V["a"],VCardText:V["c"],VCol:R["a"],VDataTable:w["a"],VForm:A["a"],VIcon:C["a"],VRow:b["a"],VSpacer:_["a"]})}}]);